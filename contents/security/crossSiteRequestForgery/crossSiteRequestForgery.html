<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="MarkBind 2.14.1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SE-EDU/LearningResources - Cross Site Request Forgery (CSRF)</title>
  <link rel="stylesheet" href="../../../markbind/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../markbind/css/bootstrap-vue.min.css">
  <link rel="stylesheet" href="../../../markbind/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="../../../markbind/glyphicons/css/bootstrap-glyphicons.min.css">
  <link rel="stylesheet" href="../../../markbind/css/octicons.css">
  <link rel="stylesheet" href="../../../markbind/css/github.min.css">
  <link rel="stylesheet" href="../../../markbind/css/markbind.css">
  <link rel="stylesheet" href="/learningresources/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css">
  <link rel="stylesheet" href="../../../markbind/layouts/default/styles.css">
  <link rel="stylesheet" href="../../../markbind/css/site-nav.css">
  <link rel="stylesheet" href="../../../markbind/css/page-nav.css">
  <link rel="icon" href="/learningresources/favicon.ico">
</head>

<body data-spy="scroll" data-target="#page-nav" data-offset="100">
  <div id="app">
    <header>
      <navbar placement="top" type="dark" class="temp-navbar">
        <a slot="brand" href="https://se-education.org" title="SE-EDU" class="navbar-brand"><span><span aria-hidden="true" class="fas fa-chevron-circle-left"></span> <strong><strong>SE-EDU</strong></strong></span></a>
        <li><a href="/learningresources/index.html" class="nav-link"><span><strong>Home</strong></span></a></li>
        <li><a href="/learningresources/about.html" class="nav-link"><span><strong>About</strong></span></a></li>
        <li><a href="/learningresources/contributing.html" class="nav-link"><span><strong>Contributing</strong></span></a></li>
        <li><a href="https://github.com/se-edu/learningresources" class="nav-link"><span><span aria-hidden="true" class="fab fa-github"></span></span></a></li>
        <li slot="right" class="nav-link">
          <form class="navbar-form">
            <searchbar :data="searchData" placeholder="Search this site" :on-hit="searchCallback" menu-align-right></searchbar>
          </form>
        </li>
      </navbar>
    </header>
    <div id="flex-body">
      <nav id="site-nav" class="navbar navbar-light bg-transparent">
        <div class="border-right-grey nav-inner position-sticky slim-scroll">
          <span id="toc">
            <ul class="px-0 site-nav-list">
              <li class="mt-2"><button class="dropdown-btn"><strong><strong>Programming Languages</strong></strong>
                  <i class="dropdown-btn-icon">
                    <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                <div class="dropdown-container">
                  <ul class="pl-3 site-nav-list">
                    <li class="mt-2"><button class="dropdown-btn">C++
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/c++/rvalue.html" class="site-nav__a">Rvalue References and Move Semantics</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">CSharp
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/csharp/IntroductionToCSharp.html" class="site-nav__a">Introduction to CSharp</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/csharp/CSAsyncAwait.html" class="site-nav__a">Asynchronous Programming in C#</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/dart/Dart.html" class="site-nav__a">Dart</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/elm/Elm.html" class="site-nav__a">Elm</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/go/Go.html" class="site-nav__a">Go</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/haskell/Haskell.html" class="site-nav__a">Haskell</a></li>
                    <li class="mt-2"><button class="dropdown-btn">Java
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/java/JavaConcurrency.html" class="site-nav__a">Java Concurrency</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/java/streams-an-introduction.html" class="site-nav__a">Java Streams</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/java/JavaSynchronization.html" class="site-nav__a">Java Synchronization</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/java/JavaReflections.html" class="site-nav__a">Java Reflection</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/java/JUnit.html" class="site-nav__a">JUnit</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">JavaScript
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/javascript/WritingTestableJavascript.html" class="site-nav__a">Writing Testable JavaScript Code</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-promises.html" class="site-nav__a">Javascript Promises</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-modules.html" class="site-nav__a">Javascript Modules</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/javascript/staticTypingInJavascript.html" class="site-nav__a">Static Typing in JavaScript</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Kotlin
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/kotlin/kotlin.html" class="site-nav__a">Introduction to Kotlin</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/kotlin/NullSafety.html" class="site-nav__a">Null Safety In Kotlin</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Python
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/python/introduction-to-python.html" class="site-nav__a">Introduction to Python</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/python/numpy.html" class="site-nav__a">NumPy</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/ruby/Ruby.html" class="site-nav__a">Ruby</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/rust/Rust.html" class="site-nav__a">Rust</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/scala/Scala.html" class="site-nav__a">Scala</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/swift/welcome-to-swift.html" class="site-nav__a">Swift</a></li>
                  </ul>
                </div>
              </li>
              <li class="mt-2"><button class="dropdown-btn"><strong><strong>SE Topics</strong></strong>
                  <i class="dropdown-btn-icon">
                    <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                <div class="dropdown-container">
                  <ul class="pl-3 site-nav-list">
                    <li class="mt-2"><button class="dropdown-btn">Architecture
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/architecture/RESTArchitecturalStyle.html" class="site-nav__a">REST</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Code Quality
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/codeQuality/CodeQualityMetrics.html" class="site-nav__a">Code Quality Metrics</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/projectManagement/documentation.html" class="site-nav__a">Documentation</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/functionalProgramming/intro.html" class="site-nav__a">Functional Programming</a></li>
                    <li class="mt-2"><button class="dropdown-btn">Performance
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/performance/Performance.html" class="site-nav__a">Introduction to Performance Optimization</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/performance/PerformanceProfiling.html" class="site-nav__a">Performance Profiling</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/performance/WebPerformance.html" class="site-nav__a">Web Performance</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Project Management
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/projectManagement/AgileDevelopment.html" class="site-nav__a">Agile Development</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/devops/DevOps.html" class="site-nav__a">DevOps</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/projectManagement/githubActions.html" class="site-nav__a">Github Actions</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Revision Control
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/revisionControl/bestPracticesGit.html" class="site-nav__a">Best Practices with git</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/scalability/scalable-development.html" class="site-nav__a">Scalability</a></li>
                    <li class="mt-2"><button class="dropdown-btn">Static Analysis
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/staticAnalysis/intro.html" class="site-nav__a">Introduction to Static Analysis</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/staticAnalysis/checkStyle.html" class="site-nav__a">CheckStyle</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/staticAnalysis/PMD.html" class="site-nav__a">PMD</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/staticAnalysis/FindBugs.html" class="site-nav__a">FindBugs</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/staticAnalysis/ESLint.html" class="site-nav__a">ESLint</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Testing
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/testing/integration-testing.html" class="site-nav__a">Integration Testing</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/testing/security-testing.html" class="site-nav__a">Security Testing</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/testing/testDrivenDevelopment.html" class="site-nav__a">Test-Driven Development</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/testing/writing-testable-code.html" class="site-nav__a">Writing Testable Code</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">UI/UX
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/uix/accessibility.html" class="site-nav__a">Accessibility</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/uix/design-systems.html" class="site-nav__a">Design Systems</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/uix/uix.html" class="site-nav__a">Introduction to UI/UX</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/uix/refining-ux-skills.html" class="site-nav__a">Refining UX Design Skills</a></li>
                        </ul>
                      </div>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="mt-2"><button class="dropdown-btn"><strong><strong>App Frameworks</strong></strong>
                  <i class="dropdown-btn-icon">
                    <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                <div class="dropdown-container">
                  <ul class="pl-3 site-nav-list">
                    <li class="mt-2"><a href="/learningresources/contents/android/IntroToAndroid.html" class="site-nav__a">Android</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-framework-Angular.html" class="site-nav__a">Angular</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/ios/IntroToIos.html" class="site-nav__a">iOS</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/node/nodejs.html" class="site-nav__a">Node</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-framework-React.html" class="site-nav__a">React</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-framework-Redux.html" class="site-nav__a">Redux</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/ruby/Rails.html" class="site-nav__a">Ruby on Rails</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/java/Spring.html" class="site-nav__a">Spring</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/javascript/Javascript-framework-VueJs.html" class="site-nav__a">Vue</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/csharp/Xamarin.html" class="site-nav__a">Xamarin</a></li>
                  </ul>
                </div>
              </li>
              <li class="mt-2"><button class="dropdown-btn"><strong><strong>Tools Useful for Software Engineers</strong></strong>
                  <i class="dropdown-btn-icon">
                    <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                <div class="dropdown-container">
                  <ul class="pl-3 site-nav-list">
                    <li class="mt-2"><a href="/learningresources/contents/regex/Regex.html" class="site-nav__a">Regular Expressions</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/docker/Docker.html" class="site-nav__a">Docker</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/zeromq/zeromq.html" class="site-nav__a">ZeroMQ</a></li>
                    <li class="mt-2"><a href="/learningresources/contents/dotfiles/Dotfiles.html" class="site-nav__a">Dotfiles</a></li>
                  </ul>
                </div>
              </li>
              <li class="mt-2"><button class="dropdown-btn dropdown-btn-open"><strong><strong>Other Topics</strong></strong>
                  <i class="dropdown-btn-icon rotate-icon">
                    <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                <div class="dropdown-container dropdown-container-open">
                  <ul class="pl-3 site-nav-list">
                    <li class="mt-2"><a href="/learningresources/contents/computerVision/cv.html" class="site-nav__a">Computer Vision</a></li>
                    <li class="mt-2"><button class="dropdown-btn">Databases
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/data/databases/databases.html" class="site-nav__a">DBMS</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/data/sql/SQL.html" class="site-nav__a">SQL</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/data/nosql/NoSQL.html" class="site-nav__a">NoSQL</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/ai/ml.html" class="site-nav__a">Machine Learning</a></li>
                    <li class="mt-2"><button class="dropdown-btn">Multi-Threading
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/gpgpu/gpgpu.html" class="site-nav__a">GPGPU</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/gpgpu/cuda.html" class="site-nav__a">CUDA</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><a href="/learningresources/contents/naturalLanguage/nl.html" class="site-nav__a">Natural Language Processing</a></li>
                    <li class="mt-2"><button class="dropdown-btn dropdown-btn-open">Security
                        <i class="dropdown-btn-icon rotate-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container dropdown-container-open">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/security/crossSiteRequestForgery/crossSiteRequestForgery.html" class="site-nav__a current">Cross Site Request Forgery</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/security/crossSiteScripting/crossSiteScripting.html" class="site-nav__a">Cross Site Scripting</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/security/cryptography.html" class="site-nav__a">Cryptography</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/security/Https.html" class="site-nav__a">HTTPS</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/security/passwordStorage.html" class="site-nav__a">Password Storage</a></li>
                          <li class="mt-2"><a href="/learningresources/contents/security/sqlInjection.html" class="site-nav__a">SQL Injection</a></li>
                        </ul>
                      </div>
                    </li>
                    <li class="mt-2"><button class="dropdown-btn">Shell
                        <i class="dropdown-btn-icon">
                          <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span></i></button>
                      <div class="dropdown-container">
                        <ul class="pl-3 site-nav-list">
                          <li class="mt-2"><a href="/learningresources/contents/shells/bash.html" class="site-nav__a">bash</a></li>
                        </ul>
                      </div>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </span></div>
      </nav>

      <div id="content-wrapper">
        <h1 id="a-student-s-guide-to-software-engineering-tools-and-amp-techniques"><span class="text-dark"><strong><strong>A Student's Guide to Software Engineering Tools &amp; Techniques »</strong></strong></span><a class="fa fa-anchor" href="#a-student-s-guide-to-software-engineering-tools-and-amp-techniques" onclick="event.stopPropagation()"></a></h1>
        <div class="website-content">
          <h1 id="cross-site-request-forgery-csrf">Cross Site Request Forgery (CSRF)<a class="fa fa-anchor" href="#cross-site-request-forgery-csrf" onclick="event.stopPropagation()"></a></h1>
          <p>Author: <a href="https://github.com/tran-tien-dat">Tran Tien Dat</a></p>
          <box id="article-toc">
            <ul>
              <li><a href="#flow-of-a-csrf-attack">Flow of a CSRF attack‎</a>
                <ul>
                  <li><a href="#step-1-the-victim-logs-in-to-a-vulnerable-web-service">Step 1: The Victim Logs in to a Vulnerable Web Service‎</a></li>
                  <li><a href="#step-2-the-victim-visits-an-untrusted-website-controlled-by-the-attacker">Step 2: The Victim Visits an Untrusted Website Controlled by the Attacker‎</a></li>
                  <li><a href="#step-3-the-untrusted-website-makes-requests-to-the-vulnerable-web-service-on-the-victim-s-behalf">Step 3: The Untrusted Website Makes Requests to the Vulnerable Web Service on the Victim's Behalf‎</a></li>
                </ul>
              </li>
              <li><a href="#conditions-for-a-successful-csrf-attack">Conditions for a Successful CSRF Attack‎</a></li>
              <li><a href="#defense-against-csrf-attacks">Defense Against CSRF Attacks‎</a></li>
              <li><a href="#references">References‎</a></li>
            </ul>
          </box>

          <p>Cross-Site Request Forgery (CSRF) is a dangerous type of attack that has affected major sites like <a href="http://archive.oreilly.com/pub/post/gmail_exploit_contact_list_hij.html">Gmail</a> and <a href="https://blog.jeremiahgrossman.com/2006/10/more-on-netflixs-csrf-advisory.html">Netflix</a> in the past. This article attempts to give an easy-to-digest introduction to the attack and how to protect your website from it.</p>
          <h2 id="flow-of-a-csrf-attack">Flow of a CSRF Attack<a class="fa fa-anchor" href="#flow-of-a-csrf-attack" onclick="event.stopPropagation()"></a></h2>
          <p>A CSRF attack tricks the victim to perform actions that they do not intend to do on a web application in which they're currently authenticated. It generally consists of 3 steps:</p>
          <ol>
            <li>The victim logs in to a vulnerable web service</li>
            <li>The victim visits an untrusted website controlled by the attacker</li>
            <li>The untrusted website makes requests to the vulnerable web service on the victim's behalf</li>
          </ol>
          <p>These steps are best explained through an example. Suppose that Alice is a customer of the banking website <code>www.example-bank.com</code>. Alice wants to transfer money to her friend Bob (because she does not like the fact that he keeps paying for her meals when they go out together).</p>
          <h3 id="step-1-the-victim-logs-in-to-a-vulnerable-web-service">Step 1: The Victim Logs in to a Vulnerable Web Service<a class="fa fa-anchor" href="#step-1-the-victim-logs-in-to-a-vulnerable-web-service" onclick="event.stopPropagation()"></a></h3>
          <p>Alice first logs in to the website at <code>www.example-bank.com/login</code>, providing her username and password. She then clicks on a hyperlink on the site to go to the URL <code>www.example-bank.com/transfer</code> to perform her transaction. Note that Alice does not have to enter her username and password again, but the bank still knows that the request is made by her. This is done through a mechanism of the HTTP protocol called a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">HTTP Cookie</a>. A <em>cookie</em> is a small piece of information that is sent along with all HTTP requests to a particular website. In our case, after receiving Alice's credentials for logging in, the bank instructs Alice's browser to store a <em>cookie</em> <code>auth=1abcd2ek3292fsa390sdf</code> and <strong>send this cookie together with every subsequent request</strong> to <code>www.example-bank.com</code>. Thus, once the web server sees this cookie in the request, it knows that this is an authenticated request from Alice. Many websites use this cookie mechanism so that users only have to log in once.</p>
          <p>At <code>www.example-bank.com/transfer</code>, Alice fills out the following HTML form to transfer money to Bob:</p>
          <pre><code class="hljs HTML"><span><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/transfer"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-name"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Bob"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-account-no"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"123456"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"amount"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></span></code></pre>
          <p>As Alice clicks the submit button, the browser will send the following request to <code>www.example-bank.com</code>:</p>
          <pre><code class="hljs"><span>POST https://www.example-bank.com/transfer HTTP/1.1<br></span><span>Cookie: auth=1abcd2ek3292fsa390sdf<br></span><span><br></span><span>receiver-name=Bob&amp;receiver-account-no=123456&amp;amount=100<br></span></code></pre>
          <p>The bank's server verifies that the cookie <code>auth=1abcd2ek3292fsa390sdf</code> is valid and is associated with Alice. It then proceeds to transfer $100 from Alice's account to account number 123456, which belongs to Bob.</p>
          <h3 id="step-2-the-victim-visits-an-untrusted-website-controlled-by-the-attacker">Step 2: The Victim Visits an Untrusted Website Controlled by the Attacker<a class="fa fa-anchor" href="#step-2-the-victim-visits-an-untrusted-website-controlled-by-the-attacker" onclick="event.stopPropagation()"></a></h3>
          <p>Alice then receives a chat message from her not-so-trustworthy friend, Eve:</p>
          <pre><code class="hljs"><span>Eve: OMG Alice! This site is selling the shoes you have always<br></span><span>     wanted for half the price: www.i-am-not-evil.com/shoes<br></span></code></pre>
          <p>Excited by this piece of news, Alice clicks on the hyperlink to check out <code>www.i-am-not-evil.com</code>.</p>
          <h3 id="step-3-the-untrusted-website-makes-requests-to-the-vulnerable-web-service-on-the-victim-s-behalf">Step 3: The Untrusted Website Makes Requests to the Vulnerable Web Service on the Victim's Behalf<a class="fa fa-anchor" href="#step-3-the-untrusted-website-makes-requests-to-the-vulnerable-web-service-on-the-victim-s-behalf" onclick="event.stopPropagation()"></a></h3>
          <p>While browsing <code>www.i-am-not-evil.com</code>, Alice clicks on the <code>View more pictures</code> button on the website to see more pictures of her favorite pair of shoes. Unbeknownst to her, that button has the following HTML code:</p>
          <pre><code class="hljs HTML"><span><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"https://www.example-bank.com/transfer"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-name"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Eve"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-account-no"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"987654"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"amount"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100000"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"View more pictures"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></span></code></pre>
          <p>So, when she clicks that button, the browser actually sends the following request to <code>https://www.example-bank.com</code>:</p>
          <pre><code class="hljs"><span>POST https://www.example-bank.com/transfer HTTP/1.1<br></span><span>Cookie: auth=1abcd2ek3292fsa390sdf<br></span><span><br></span><span>receiver-name=Eve&amp;receiver-account-no=987654&amp;amount=100000<br></span></code></pre>
          <p>Since Alice is still logged in to <code>www.example-bank.com</code>, the browser automatically attaches the cookie <code>auth=1abcd2ek3292fsa390sdf</code> to any requests made to <code>www.example-bank.com</code>. Hence, the bank's server considers this as an authenticated request from Alice and proceeds to transfer $100,000 from Alice's account to account number 987654, which belongs to the attacker!</p>
          <h2 id="conditions-for-a-successful-csrf-attack">Conditions for a Successful CSRF Attack<a class="fa fa-anchor" href="#conditions-for-a-successful-csrf-attack" onclick="event.stopPropagation()"></a></h2>
          <p>From the example, we can see that a CSRF attack works by forging a valid request which <strong>inherits the identity and privileges of the victim</strong> on the vulnerable web server. Such inheritance of privileges is possible because the browser attaches any credentials associated with a website to all requests made to the site. Therefore, if the user is currently authenticated to the site, the site will have no way to distinguish between the forged request sent by the victim and a legitimate request sent by the victim. In short, there are 3 conditions necessary for the attack:</p>
          <ol>
            <li>The target website is vulnerable to a CSRF attack (i.e. it cannot distinguish between forged and legitimate requests).</li>
            <li>The victim is authenticated to the target website.</li>
            <li>The victim is tricked to visit an untrusted website by social engineering.</li>
          </ol>
          <p><em>Note: <a href="https://en.wikipedia.org/wiki/Social_engineering_%28security%29">Social engineering</a> refers to psychological manipulation of people into performing actions. In our example, Eve shares a link with a description that matches Alice's interest, which increases the chance that Alice will follow the link. Thus, this action is a form of social engineering.</em></p>
          <h2 id="defense-against-csrf-attacks">Defense Against CSRF Attacks<a class="fa fa-anchor" href="#defense-against-csrf-attacks" onclick="event.stopPropagation()"></a></h2>
          <p>Both users and websites can take actions to defend themselves against CSRF attacks. As the user, one can reduce the likelihood of being attacked by logging out of sensitive services like banking immediately after carrying out transactions. This will negate condition number 2. Condition number 3 can be mitigated if the user is extremely careful and never visits websites they do not know. However, users generally do not follow this and just click on interesting links they encounter on social media. Hence, this threat of social engineering could never be fully eliminated.</p>
          <p>As for the web server, it can eliminate condition number 1 by adding a secret token as a hidden field to all forms that it serves. This token should be random and cannot be guessed by the attacker. Back to our example, the bank website should use a form like the following:</p>
          <pre><code class="hljs HTML"><span><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/transfer"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"csrf-token"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"abcd23ksk3l2faad2kdkl"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-name"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Bob"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"receiver-account-no"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"123456"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"amount"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>/&gt;</span><br></span><span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></span></code></pre>
          <p>So a valid request by Alice made from the bank's own website will also carry this secret token <code>csrf-token=abcd23ksk3l2faad2kdkl</code>. Since the token is added by the bank's website on its webpages, forged requests from other websites will not know the token. Thus, when the bank's server receives a request, it can distinguish between a legitimate and a forged request by checking that the CSRF token is present and valid.</p>
          <h2 id="references">References<a class="fa fa-anchor" href="#references" onclick="event.stopPropagation()"></a></h2>
          <ul>
            <li><a href="https://owasp.org/www-community/attacks/csrf">https://owasp.org/www-community/attacks/csrf</a> (A more technical description of the attack)</li>
            <li><a href="https://owasp.org/www-project-cheat-sheets/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">https://owasp.org/www-project-cheat-sheets/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html</a> (In-depth discussion of the various defense approaches, including those that do not work)</li>
            <li><a href="https://www.cgisecurity.com/csrf-faq.html">https://www.cgisecurity.com/csrf-faq.html</a> (Short FAQs about CSRF)</li>
            <li><a href="https://docs.djangoproject.com/en/2.0/ref/csrf/">https://docs.djangoproject.com/en/2.0/ref/csrf/</a> (CSRF Protection in Django)</li>
          </ul>
        </div>
      </div>


      <nav id="page-nav" class="navbar navbar-light bg-transparent">
        <div class="border-left-grey nav-inner position-sticky slim-scroll">

          <nav class="nav nav-pills flex-column my-0 small no-flex-wrap">
            <a class="nav-link py-1" href="#a-student-s-guide-to-software-engineering-tools-and-amp-techniques">A Student's Guide to Software Engineering Tools &amp; Techniques »&#x200E;</a>
            <a class="nav-link py-1" href="#cross-site-request-forgery-csrf">Cross Site Request Forgery (CSRF)&#x200E;</a>
            <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap">
              <a class="nav-link py-1" href="#flow-of-a-csrf-attack">Flow of a CSRF Attack&#x200E;</a>
              <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap">
                <a class="nav-link py-1" href="#step-1-the-victim-logs-in-to-a-vulnerable-web-service">Step 1: The Victim Logs in to a Vulnerable Web Service&#x200E;</a>
                <a class="nav-link py-1" href="#step-2-the-victim-visits-an-untrusted-website-controlled-by-the-attacker">Step 2: The Victim Visits an Untrusted Website Controlled by the Attacker&#x200E;</a>
                <a class="nav-link py-1" href="#step-3-the-untrusted-website-makes-requests-to-the-vulnerable-web-service-on-the-victim-s-behalf">Step 3: The Untrusted Website Makes Requests to the Vulnerable Web Service on the Victim's Behalf&#x200E;</a>
              </nav>
              <a class="nav-link py-1" href="#conditions-for-a-successful-csrf-attack">Conditions for a Successful CSRF Attack&#x200E;</a>
              <a class="nav-link py-1" href="#defense-against-csrf-attacks">Defense Against CSRF Attacks&#x200E;</a>
              <a class="nav-link py-1" href="#references">References&#x200E;</a>
            </nav>

          </nav>
        </div>
      </nav>
    </div>
    <footer>

      <div class="text-center">
        <small>[Powered by <img src="https://markbind.org/favicon.ico" width="30"> <a href="https://markbind.org/">MarkBind 2.14.1</a> on Sun, May 31, 2020, 3:36:04 AM UTC]</small></div>
    </footer>
  </div>
</body>
<script src="../../../markbind/js/vue.min.js"></script>
<script src="../../../markbind/js/vue-strap.min.js"></script>
<script src="../../../markbind/js/bootstrap-utility.min.js"></script>
<script src="../../../markbind/js/polyfill.min.js"></script>
<script src="../../../markbind/js/bootstrap-vue.min.js"></script>
<script>
  const baseUrl = '/learningresources'
  const enableSearch = true
</script>
<script src="../../../markbind/js/setup.js"></script>
<script src="../../../markbind/layouts/default/scripts.js"></script>

</html>